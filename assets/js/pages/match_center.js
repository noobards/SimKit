simkit.app.controller("matchCenter", function($scope, $http, $window){	$scope.data = {};	$scope.data.home = 0;	$scope.data.away = 0;	$scope.data.home_label = "";	$scope.data.away_label = "";	$scope.data.players_selected = false;	$http({		method: 'get',		url: simkit.baseUrl+'MatchCenter/getMyTeams'			}).then(function success(resp){		if(resp.statusText == "OK")		{			$scope.data.teams = resp.data.teams;			$scope.data.team_count = $scope.data.teams.length;			if($scope.data.teams.length > 0)			{				$scope.data.home = $scope.data.teams[0].team_id;				$scope.data.away = $scope.data.teams[0].team_id;				}					}		else		{			alert(resp.statusText);		}	}, function error(resp){		alert(resp.statusText);	}).then(function complete(){			});			jQuery('#config_match').on('show.bs.collapse','.collapse', function() {		jQuery('#config_match').find('.collapse.in').collapse('hide');	});		$scope.goNext = function(e, panel_id){		var button = jQuery(e.currentTarget);		var current_panel = button.attr('data-current-panel');		if(current_panel == 'panel_1')		{			// check if home and away teams are same			if($scope.data.home == $scope.data.away)			{								alert("Home and Away teams cannot be same");				return false;			}			$scope.loading("panel_1");			$http({				method: 'post',				data: $scope.data,				url: simkit.baseUrl+'MatchCenter/getCompetingTeamPlayers'			}).then(function success(resp){				if(resp.statusText == "OK")				{					if(resp.data.status == "OK")					{						$scope.data.team_players = resp.data.db;												jQuery('#config_match #panel_2').collapse('show');					}					else					{						alert(resp.data.msg);					}				}				else				{					alert(resp.statusText);				}			}, function error(resp){				alert(resp.statusText);			}).then(function complete(){				$scope.finish("panel_1");			});		}		else if(current_panel == 'panel_2')		{			// check if 11 players have been selected from both teams			var home_cnt = jQuery('.table-mockup[data-mode="home"]').find('.tr.selected').length;			var away_cnt = jQuery('.table-mockup[data-mode="away"]').find('.tr.selected').length;			if(home_cnt != 11 || away_cnt != 11)			{				alert("11 players must be selected from Home and Away team.");				return false;			}			else			{				jQuery('#config_match #panel_3').collapse('show');			}		}			};	$scope.goPrev = function(e, panel_id){		jQuery('#config_match #'+panel_id).collapse('show');	};	$scope.playerSelect = function(e){		var cb = jQuery(e.target);				var tr = cb.closest('.tr');		var table  = cb.closest('.table-mockup');		var mode = table.attr('data-mode');		if(cb.is(':checked'))		{			tr.addClass('selected');		}		else		{			tr.removeClass('selected');		}		var cnt = table.find('.tr.selected').length;		table.siblings('.selection_number').html(cnt+ ' selected');		if(cnt == 11)		{			table.siblings('.selection_number').addClass('green').removeClass('red');			table.find(':checkbox').not(':checked').attr('disabled', 'disabled');		}		else if(cnt == 0)		{			table.siblings('.selection_number').removeClass('green').removeClass('red');		}		else		{			table.siblings('.selection_number').removeClass('green').addClass('red');			table.find(':checkbox').not(':checked').removeAttr('disabled');		}		if(mode == 'home')		{			// count number of selected players in away table			var cnt2 = jQuery('.table-mockup[data-mode="away"]').find('.tr.selected').length;			if(cnt == 11 && cnt2 == 11)			{				$scope.data.players_selected = true;			}			else			{				$scope.data.players_selected = false;			}		}		else if(mode == 'away')		{			// count number of selected players in home table			var cnt2 = jQuery('.table-mockup[data-mode="home"]').find('.tr.selected').length;			if(cnt == 11 && cnt2 == 11)			{				$scope.data.players_selected = true;			}			else			{				$scope.data.players_selected = false;			}		}	};		$scope.moveUp = function(e, mode){		var margin_top = jQuery('.list_of_teams').height();				var arrow = jQuery(e.currentTarget);				var cont = arrow.siblings('.list_of_teams');		var active_box = cont.find('.team.team_active');		var index = active_box.attr('data-index');				if(index == $scope.data.team_count)		{						return false;		}		else		{			cont.siblings('.arrow_down').removeClass('arrow_disabled');			if(index == ($scope.data.team_count - 1))			{				cont.siblings('.arrow_up').addClass('arrow_disabled');			}			else			{				cont.siblings('.arrow_up').removeClass('arrow_disabled');			}						active_box.css({				marginTop: -(margin_top)+'px'			});			active_box.next().addClass('team_active').css('marginTop', '0px');			active_box.removeClass('team_active');			$scope.setHomeAway(mode, cont);		}	};		$scope.moveDown = function(e, mode){		var margin_top = jQuery('.list_of_teams').height();			var arrow = jQuery(e.currentTarget);		var cont = arrow.siblings('.list_of_teams');		var active_box = cont.find('.team.team_active');		var index = active_box.attr('data-index');		if(index == '1')		{						return false;		}		else		{			cont.siblings('.arrow_up').removeClass('arrow_disabled');			if(index == '2')			{				cont.siblings('.arrow_down').addClass('arrow_disabled');			}			else			{				cont.siblings('.arrow_down').removeClass('arrow_disabled');			}						active_box.css({				marginTop: (margin_top)+'px'			});			active_box.prev().addClass('team_active').css('marginTop', '0px');			active_box.removeClass('team_active');			$scope.setHomeAway(mode, cont);		}	};	$scope.setHomeAway = function(type, box){		if(type == 'home')		{			$scope.data.home = box.find('.team.team_active').attr('data-tid');			$scope.data.home_label = box.find('.team.team_active').attr('data-team');		}		else if(type == 'away')		{			$scope.data.away = box.find('.team.team_active').attr('data-tid');			$scope.data.away_label = box.find('.team.team_active').attr('data-team');		}		else		{			$scope.data.home = 0;			$scope.data.away = 0;			$scope.data.home_label = "";			$scope.data.away_label = "";		}	};});